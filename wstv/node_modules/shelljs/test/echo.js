function numLines(e){return typeof e=="string"?e.match(/\n/g).length:0}function theEnd(){shell.exit(123)}var shell=require(".."),assert=require("assert"),path=require("path"),fs=require("fs"),child=require("child_process");fs.existsSync=fs.existsSync||path.existsSync,shell.silent(!0),shell.rm("-rf","tmp"),shell.mkdir("tmp"),shell.mkdir("-p","tmp");var file="tmp/tempscript"+Math.random()+".js",script="require('../../global.js'); echo(111);";script.to(file),child.exec("node "+file,function(e,t,n){assert.ok(t==="111\n"||t==="111\nundefined\n"),shell.mkdir("-p","tmp");var r="tmp/tempscript"+Math.random()+".js",i="require('../../global.js'); silent(true); echo(555);";i.to(r),child.exec("node "+r,function(e,t,n){assert.ok(t==="555\n"||t==="555\nundefined\n"),theEnd()})});